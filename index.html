<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TNM108: Report</title>
</head>

<style>
    body {
    font-family: Arial, sans-serif;
    background-color: #f0f0f0;
    color: #333;
    margin: 0;
    padding: 0;
}
#header {
    background-color: #333;
    color: #fff;
    padding: 20px;
    text-align: center;
    box-shadow: 0 0 0 20px firebrick, 0px 30px 50px 13px rgba(0,0,0,0.21);
    outline: dashed 20px whitesmoke;
}
#content {
    width: 800px;
    margin: 20px auto;
    background-color: #fff;
    padding: 20px;
    border: 1px solid #ccc;
    box-shadow: 0px 0px 10px 2px rgba(0,0,0,0.21);
}
.post {
    margin-bottom: 20px;
}
.post h2 {
    margin: 0;
    padding: 0;
    font-size: 24px;
    color: #333;
}
.post p {
    font-size: 14px;
    line-height: 1.6;
}
.twoCol{
    display:flex;
    padding: 0px 24px 0px 0px;
}
#footer {
    background-color: #333;
    color: #fff;
    text-align: center;
    padding: 10px;
    position: fixed;
    width: 100%;
    bottom: 0;
    box-shadow: 0 0 0 20px firebrick, 0px -10px 50px 13px rgba(0,0,0,0.21);
    outline: dashed 20px whitesmoke;
}
ul{
    padding-left: 0;
}
</style>
<body>
    <div id="header">
        <h1>TNM108: Formula One Recommender System </h1>
    </div>
    <div id="content" style="margin-top: 40px;">
        <div class="post">
            <h2>Link to code</h2>
            <ul>
                <a href="https://github.com/PhilipRobertsson/TNM108-Project-F1-Recommender">Github - Self Sufficient Program</a><br>
                <a href="https://colab.research.google.com/drive/1lQmXAPcosVUV5ej2tuzm35eufNz65mqs?usp=sharing">Google Colab - Needs connection to google drive</a>
            </ul>
        </div>
    </div>
    <div id="content">
        <div class="post">
            <h2>Background</h2>
            <p>The goal of this project is to explore the posibility of creating a system that can recommend suitible Formula One races to watch for individuals or a group of people. A system like this would allow
                for fans of Formula One to easier find races to watch or for groups of friends to find races which would suit everyone the best. The prediction should be based on the users favorite drivers, constructors,
                circuits and, races to get more accurate predictions. A system like this does require large amounts of data to be accurate and thus a requirment for this project is to find a suitible dataset which holds
                information about all 1125 races in the history of Formula One (as of the end of the 2024 season).
            </p>
        </div>
        <div class="post">
            <h2>PCA</h2>
            <p>Principal Component Analysis (PCA) is a statistical technique used to emphasize variation and bring out strong patterns in a dataset. It is often used to make data easy to explore and visualize. PCA works by transforming the original variables into a new set of variables, the principal components, which are orthogonal and capture the maximum variance in the data.
            </p>
        </div>
    </div>
    <div id="content">
        <div class="post">
            <h2>Reasearch Question</h2>
            <p>
            </p>
        </div>
    </div>
    <div id="content">
        <div class="post">
            <h2>Dataset</h2>
            <div class="twoCol">
                <p> This system utilises the dataset "Formula 1 World Championship (1950 - 2024)" by Vopani on Kaggle which is linked below. As mentioned in the title of the dataset it contains every grand prix from 1950
                    and forwards with data about the circuits that have been used as venues, the drivers and consturctors that have competed in the championship, and qualification and race results. All the csv files that
                    make up the dataset can be seen in the image on the right.
                    <br/>
                    <br/>
                    There are some drawbacks with this dataset however, for a start it does not have the qualification or race results for the second half of the 2024 season given that it hasn't been updated for six months
                    (as of 2025-01-15). This of course mean that the system cannot account for some of the most recent results in the championship. Furthermore, the order which the drivers and consturcotrs finished during
                    the qualification and race is missing from some of the races that happaned about 40 years ago. This means that these races can't be used for prediction, but a large majority of races are available and
                    the dataset is therefore usable.
                </p>
                <p><img src="images/csv_files.png" alt="csv file list" height="256" style="margin-left: 24px;"></p>
            </div>
            <p> The dataset also contains files which where unused in this project given that their data were deemed to not be important enough to make good predictions. These being for
                example the two diffrent standings files which only indicates how the championship standing evolved during a season, thus not being relevant when watching races in a "one-off" manner. Lap times and pitstop
                data was also exluded given the lack of data in them (about 300 races covered each). The seosons file was also kept unused as it only contains Wikipedia links to all 75 seasons, and the status file was
                exluded for a similar reason given that it only contains data to indicate why a driver did not finish a race or how many laps down they were from the lead lap. Lastly the sprint results were exluded as sprints
                only have been driven since 2021, thus containing a very small amount of data compared to the races.
            </p>
            <p><a href="https://www.kaggle.com/datasets/rohanrao/formula-1-world-championship-1950-2020">Link to dataset</a></p>
            <h2>Training & Test data</h2>
            <p> bla
            </p>
            <h2>Data preprocessing</h2>
            <p> As can be seen in the image of the csv files, they are rather split up and it could be more efficent to work with one large file containing data from several parts of diffrent files. To do this it was chosen to
                use the file <a href="https://github.com/PhilipRobertsson/TNM108-Project-F1-Recommender/blob/main/F1Data/races.csv">races.csv</a> as a base for a new and expanded dataset. This base file contains
                every grand prix that has been held and the index <i>raceId</i> is a value that is consistent for a given grand prix in all of the csv files which greatly helps when searching through the other files. The general
                structure of <a href="https://github.com/PhilipRobertsson/TNM108-Project-F1-Recommender/blob/main/F1Data/races.csv">races.csv</a> can be seen in the image below.
            </p>
            <p><img src="images/racesStructure.png" alt="races.csv structure" width="100%"></p>
            <p> As can be seen in the image it shows the entirety of the 2009 with raceIds from 1-17, futhermore, it's apparent that alot of the data is missing such as the time of the day when practice, qualifying, and sprint
                started and what date they occurred on. These colums does lack this data for a large majority of the races as previously mentioned and are therefore immedietly dropped from the dataset as those won't be used. The
                time of day the race was held on was also dropped as this value was unsused for this project.
            </p>
            <p> With the base dataset slimmed down, additional columns with more usable values could be added. It was decided that the most interesting data would be the order of the qualification and the race result
                for both the drivers and constructors. To achive this both <a href="https://github.com/PhilipRobertsson/TNM108-Project-F1-Recommender/blob/main/F1Data/qualifying.csv">qualifying.csv</a> and
                <a href="https://github.com/PhilipRobertsson/TNM108-Project-F1-Recommender/blob/main/F1Data/results.csv">results.csv</a> where searched through to add all drivers and constructors which partook
                in a grand prix weekend into four diffrent vectors for each grand prix. The base dataset now contained the additional columns <i>driverQuali</i>, <i>constructorsQuali</i>,  <i>driversPosition</i>, and <i>constructorsPosition</i>.
            </p>
            <p> Given that these four new columns only contained numerical vectors it was decided that they could be used to generate two cosine similarities between the qualification order and the race result which could represent how 
                exciting a race was. The argument for this was that if alot of changes happened during the grand prix the vectors would be less similar and thus contribute to a lower value for cosine similarity. With that the vectors in <i>driverQuali</i>
                and <i>constructorsQuali</i> was compared to the vectors in  <i>driversPosition</i> and <i>constructorsPosition</i> respectivley for each grand prix ever held. This gave the values <i>driverCosim</i> and <i>constrCosim</i> which could be
                added into two new separate columns in the base dataset. One important thing to note here is that there were some instances where a driver was injured during qualifying and thus couldn't partake in the race thus not beign present in the 
                result vector. In these few cases those drivers where simply exluded from the qualifying vector to make sure that both vectors were the same length when the cosine similarity was calculated.
            </p>
            <div class="twoCol">
                <p> To have additional weights when predicting races for the users it was decided that an interesting factor could be how far each individual driver climed or fell in the order during the race. This value was stored as a tuple with the drivers 
                    <i>driverId</i> (which is a unique value from <a href="https://github.com/PhilipRobertsson/TNM108-Project-F1-Recommender/blob/main/F1Data/drivers.csv">drivers.csv</a>) along with how many positions they gained or lost. All tuples for
                    a grand prix was saved to a vector and added to an additional column in the base dataset and with that the preprocessing was completed.
                    <br/>
                    <br/>
                    In the image on the right hand side the data for the 2003 Italian Grand Prix can be seen. As is shown, the driver with <i>driverId</i> 30 took pole position and the win with the constructor with <i>constructorId</i> 6, which according to the 
                    files <a href="https://github.com/PhilipRobertsson/TNM108-Project-F1-Recommender/blob/main/F1Data/drivers.csv">drivers.csv</a> and <a href="https://github.com/PhilipRobertsson/TNM108-Project-F1-Recommender/blob/main/F1Data/constructors.csv">constructors.csv</a>
                    is the classic line up of Michael Schumacher driving for Ferrari. Along with this it can be seen in the column <i>PodiumClimb</i> that he indeed neither gained or lost positions when comparing his qualification to race result (it should also be noted
                    that this column does include all drivers and not only the podium finisher, the name is a left over from when the column only contained those three drivers). Laslty it can be seen that, given their closeness to 1, the driver and constructor cosine 
                    similarities indicate that this might not have been the most eventful race to watch.
                </p>
                <p><img src="images/2003ITAGP.png" alt="2003 Italian GP" width="412px"></p>
            </div>
        </div>
    </div>
    <div id="content">
        <div class="post" style="display: grid;">
            <h2>Users</h2>
            <p> As mentioned in the background section, the recommended races is based on the users preferences. Each user is defined as a profile containing their favorite driver, constructor, curcuit, and grand prix. In the current implementation the diffrent user
                profiles are hard coded and can only be changed by going through the code. Preferably this would be improved so that the user can enter these parameters through the console or in an interface. The profiles only take the name of the drivers, constructors,
                 and circuits while the favorite grand prix parameter takes both the year and the name of the grand prix. The inital parameters of the user profiles are then used to create expanded profiles with relevant information from the entire dataset. Firstly the 
                 name of the driver is used to search the <i>forename</i> and <i>surname</i> columns in <a href="https://github.com/PhilipRobertsson/TNM108-Project-F1-Recommender/blob/main/F1Data/drivers.csv">drivers.csv</a>, when the specific driver is found, their
                 <i>driverId</i> and date of birth is saved. The favorite constructor, circuit, and grand prix is also searched for in  <a href="https://github.com/PhilipRobertsson/TNM108-Project-F1-Recommender/blob/main/F1Data/constructors.csv">constructors.csv</a>,
                 <a href="https://github.com/PhilipRobertsson/TNM108-Project-F1-Recommender/blob/main/F1Data/circuits.csv">circuits.csv</a>, and <a href="https://github.com/PhilipRobertsson/TNM108-Project-F1-Recommender/blob/main/F1Data/races.csv">races.csv</a>
                 respectivley. The most important part of these searches is to find the diffrent IDs but the countries for both the constructors and circuits are also saved. In the figure below the comparison between an input profile and it's expanded counterpart is visualized.
            </p>
            <p style="justify-self: center;"><img src="images/profileComparison.png" alt="profileComparison" width="512px"></p>
        </div>
    </div>
    <div id="content">
        <div class="post">
            <h2>Implementation 1 - Euclidian distance</h2>
            <p> bla
            </p>
            <h2>Implementation 2 - KNN</h2>
            <p> blablablabla
            </p>
        </div>
    </div>
    <br><br><br><br><br><br>
    <div id="footer">
        <p>&copy; Magnus Kling, Max Wiklundh, Philip Robertsson</p>
        <p> Last updated: 15-01-2025</p>
    </div>
</body>
</html>
